<div class="tracker-container">
    <div class="tracker-content">
        <div class="tracker-header">
            <div class="header-left">
                <button class="btn-back" routerLink="/my-trackers">â† Nazad</button>
                <div class="tracker-title" *ngIf="tracker">
                    <span class="tracker-icon" [style.backgroundColor]="tracker.color + '20'">{{ tracker.icon }}</span>
                    <div class="title-text">
                        <h1>{{ tracker.name }}</h1>
                        <p>{{ tracker.description }}</p>
                    </div>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-item"><span class="stat-icon">ğŸ”¥</span><span class="stat-value">{{ streak
                        }}</span><span class="stat-label">streak</span></div>
                <div class="stat-item"><span class="stat-icon">ğŸ“Š</span><span class="stat-value">{{ weeklyProgress
                        }}%</span><span class="stat-label">sedmica</span></div>
                <div class="stat-item"><span class="stat-icon">ğŸ“</span><span class="stat-value">{{ totalEntries
                        }}</span><span class="stat-label">unosa</span></div>
            </div>
        </div>

        <!-- Date Selector -->
        <div class="date-section">
            <button class="date-picker-btn" (click)="toggleDatePicker()">
                <span class="date-icon">ğŸ“…</span>
                <span class="date-text">{{ formatDateShort(selectedDate) }}</span>
                <span class="date-arrow">â–¼</span>
            </button>

            <!-- Date Picker Popup -->
            <div class="date-picker-popup" *ngIf="showDatePicker">
                <div class="date-option" *ngFor="let date of dateOptions" [class.active]="selectedDate === date"
                    [class.today]="isToday(date)" (click)="selectDate(date)">
                    <span class="date-day">{{ getDayName(date) }}</span>
                    <span class="date-full">{{ formatDateShort(date) }}</span>
                    <span class="date-badge" *ngIf="isToday(date)">Danas</span>
                </div>
            </div>
        </div>

        <!-- Popup Overlay -->
        <div class="date-picker-overlay" *ngIf="showDatePicker" (click)="closeDatePicker()"></div>

        <div class="loading" *ngIf="isLoading">
            <div class="spinner"></div>
            <p>UÄitavanje...</p>
        </div>

        <div class="main-content" *ngIf="!isLoading">
            <div class="quote-section">
                <div class="quote-card">
                    <span class="quote-icon">ğŸ’«</span>
                    <p class="quote-text">"Zahvalnost pretvara ono Å¡to imamo u dovoljno."</p>
                </div>
            </div>

            <div class="gratitude-section">
                <h2>ğŸ™ Za Å¡to sam danas zahvalan/na?</h2>
                <p class="section-subtitle">ZapiÅ¡ite barem 3 stvari za koje ste zahvalni danas</p>

                <div class="gratitude-list">
                    <div class="gratitude-item"
                        *ngFor="let gratitude of gratitudes; let i = index; trackBy: trackByIndex">
                        <span class="gratitude-number">{{ i + 1 }}</span>
                        <input type="text" [(ngModel)]="gratitudes[i]" placeholder="Zahvalan/na sam za..."
                            class="gratitude-input">
                        <button class="btn-remove" (click)="removeGratitude(i)" *ngIf="gratitudes.length > 1">âœ•</button>
                    </div>
                </div>
                <button class="btn-add-gratitude" (click)="addGratitude()">+ Dodaj joÅ¡</button>
            </div>

            <div class="highlight-section">
                <h2>â­ DanaÅ¡nji highlight</h2>
                <p class="section-subtitle">Koji je bio najbolji dio danaÅ¡njeg dana?</p>
                <textarea [(ngModel)]="highlight" placeholder="OpiÅ¡ite vaÅ¡ omiljeni trenutak danas..."
                    rows="3"></textarea>
            </div>

            <div class="affirmation-section">
                <h2>ğŸ’ª Dnevna afirmacija</h2>
                <p class="section-subtitle">Pozitivna izjava za danaÅ¡nji dan</p>
                <textarea [(ngModel)]="affirmation" placeholder="NapiÅ¡ite svoju afirmaciju..." rows="2"></textarea>

                <div class="affirmation-suggestions">
                    <p>Ili odaberite jednu od prijedloga:</p>
                    <div class="suggestion-tags">
                        <button class="suggestion-tag" *ngFor="let suggestion of affirmationSuggestions"
                            (click)="useAffirmation(suggestion)">
                            {{ suggestion }}
                        </button>
                    </div>
                </div>
            </div>

            <button class="btn-save" (click)="saveData()" [disabled]="isSaving">
                {{ isSaving ? 'ğŸ’¾ Spremanje...' : 'ğŸ’¾ Spremi' }}
            </button>

            <div class="motivation-section">
                <h3>ğŸŒŸ ZaÅ¡to vjeÅ¾bati zahvalnost?</h3>
                <div class="benefits-grid">
                    <div class="benefit-card"><span>ğŸ˜Š</span>
                        <p>PoveÄ‡ava sreÄ‡u</p>
                    </div>
                    <div class="benefit-card"><span>ğŸ˜´</span>
                        <p>PoboljÅ¡ava san</p>
                    </div>
                    <div class="benefit-card"><span>â¤ï¸</span>
                        <p>JaÄa odnose</p>
                    </div>
                    <div class="benefit-card"><span>ğŸ§ </span>
                        <p>Smanjuje stres</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="saving-indicator" *ngIf="isSaving"><span>ğŸ’¾ Spremanje...</span></div>
    </div>
</div>